# ICMP (Internet Control Message Protocol)
*(Network Layer – Layer 3)*

ICMP is a supporting protocol used by network devices to **send error messages and operational information**.
It helps in **diagnosing and troubleshooting network issues**.

---

## Why ICMP is Needed
- To report network errors
- To test network connectivity
- To inform about unreachable destinations
- To support network troubleshooting tools

---

## Key Functions of ICMP

### 1️⃣ Error Reporting
ICMP reports problems such as:
- Destination unreachable
- Time exceeded
- Fragmentation needed but DF set

---

### 2️⃣ Network Diagnostics
ICMP is used by tools like:
- **Ping**
- **Traceroute**

These tools help identify:
- Whether a host is reachable
- Packet loss
- Network delay

---

## Common ICMP Message Types

| Type | Message | Description |
|----|--------|-------------|
| 0 | Echo Reply | Reply to ping |
| 3 | Destination Unreachable | Cannot reach host/network |
| 5 | Redirect | Better route available |
| 8 | Echo Request | Ping request |
| 11 | Time Exceeded | TTL expired |

---

## How ICMP Works (Ping Example)

1. Host sends **ICMP Echo Request**
2. Destination replies with **Echo Reply**
3. Response time is measured

Host → ICMP Echo Request → Destination

Host ← ICMP Echo Reply ← Destination

---

## Cybersecurity Perspective

### ICMP-Based Attacks
- ICMP Flood (Ping Flood)
- Smurf Attack
- ICMP Tunneling (data exfiltration)

---

### Security Controls
- Limit ICMP traffic using firewalls
- Disable unnecessary ICMP types
- Monitor ICMP traffic via IDS/IPS

---

## Why ICMP is Important in Cybersecurity
- Used for network reconnaissance
- Helps attackers map networks
- SOC teams analyze ICMP anomalies

---

## Best Practices
- Allow ICMP for internal troubleshooting
- Restrict ICMP from external networks
- Log ICMP traffic for monitoring

