# ARP (Address Resolution Protocol)

ARP is a protocol used to **map an IP address to a MAC address** within a local network (LAN).

---

## Why ARP is Needed
Devices communicate using:
- **IP address** → Logical address (Layer 3)
- **MAC address** → Physical address (Layer 2)

ARP helps a device find the **MAC address** of another device using its **IP address**.

---

## OSI Layer
- Works between **Layer 2 (Data Link)** and **Layer 3 (Network)**
- Often called a **Layer 2.5 protocol**

---

## How ARP Works (Step-by-Step)

### Example:
Device A wants to communicate with Device B.

1️⃣ Device A checks its **ARP cache**  
2️⃣ If MAC is unknown → sends **ARP Request**  
3️⃣ ARP Request is a **broadcast**  
4️⃣ Device B replies with **ARP Reply** (unicast)  
5️⃣ Device A stores the mapping in ARP cache  

---

## ARP Request
- Sent to: `FF:FF:FF:FF:FF:FF`
- Message:  > “Who has this IP? Tell me your MAC address.”

---

## ARP Reply
- Sent directly to requester
- Contains:
  - IP address
  - Corresponding MAC address

---

## ARP Cache
- Stores IP ↔ MAC mappings
- Improves performance
- Entries expire after a time

---

## Types of ARP

### 1️⃣ ARP
- IPv4 address to MAC mapping

### 2️⃣ Gratuitous ARP
- Device announces its own IP-MAC mapping
- Used for:
  - Duplicate IP detection
  - Network updates

---

## ARP in Cybersecurity

### ARP Spoofing / Poisoning
- Attacker sends fake ARP replies
- Victim maps attacker’s MAC to trusted IP

### Result:
- Man-in-the-Middle (MITM) attack
- Data interception
- Session hijacking

---

## ARP Attack Example
Victim IP → Attacker MAC
Gateway IP → Attacker MAC

---

## Prevention Techniques
- Static ARP entries
- ARP inspection
- Network segmentation
- Use HTTPS / VPN
